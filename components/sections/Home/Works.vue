<template>
  <div>
    <section class="works content-section">
      <div class="container grid custom-container grid-cols-12 gap-4">
        <div class="grid__col--full">
          <div class="content-section__head">
            <h2 class="works__title content-section__title scroll-js-title" data-splitting
              data-fx="perspective-opacity">Selected Projects</h2>
            <p class="works__dates content-section__dates scroll-js-content" data-splitting
              data-fx="overflow-horizontal">2017 - 2025</p>
            <span class="works__decorative content-section__decorative scroll-js-title" data-splitting
              data-fx="scale-words">Works</span>
          </div>
          <div class="works__lists">
            <div class="work__item work__item--0">
              <div class="work__item-box">
                <a href="https://www.manzetticlothing.com/" class="work__item-link" title="Manzetti Clothing"
                  target="_blank" rel="noopener noreferrer nofollow" data-pointer="link" data-pointer-text="Launch">
                  <div class="work__item-data">
                    <h3 class="work__item-title scroll-project-title" data-splitting>Manzetti Clothing</h3>
                    <span class="work__item-deco">01</span>
                  </div>
                  <div class="work__item-info">
                    <span class="work__item-number">01</span>
                    <span class="work__item-attrs">Development • Ecommerce • WordPress </span>
                    <span class="work__item-agency">Agency: Secret Key</span>
                    <span class="work__item-arrow svg-data">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28">
                        <path fill="#FFFFFF" fill-rule="evenodd"
                          d="M14 0C6.273 0 0 6.273 0 14s6.273 14 14 14 14-6.273 14-14S21.727 0 14 0Zm3.586 13H8c-.552 0-1 .448-1 1s.448 1 1 1h9.586l-2.293 2.293c-.39.39-.39 1.024 0 1.414.39.39 1.024.39 1.414 0l4-4c.391-.39.391-1.024 0-1.414l-4-4c-.39-.39-1.024-.39-1.414 0-.39.39-.39 1.024 0 1.414L17.586 13Z">
                        </path>
                      </svg>
                    </span>
                  </div>
                  <div class="work__item-media">
                    <img src="http://www.alessioatzeni.com/assets/manzetti_thumb_ZcsmKr.webp" class="media__image"
                      alt="Manzetti Clothing Website" width="2072" height="1237" loading="lazy" decoding="async">
                  </div>
                </a>
              </div>
            </div>
            <div class="work__item work__item--1">
              <div class="work__item-box">
                <a href="https://www.two-way.it/" class="work__item-link" title="Two Way" target="_blank"
                  rel="noopener noreferrer nofollow" data-pointer="link" data-pointer-text="Launch">
                  <div class="work__item-data">
                    <h3 class="work__item-title scroll-project-title" data-splitting>Two Way</h3>
                    <span class="work__item-deco">02</span>
                  </div>
                  <div class="work__item-info">
                    <span class="work__item-number">02</span>
                    <span class="work__item-attrs">Development • Ecommerce • WordPress </span>
                    <span class="work__item-agency">Agency: Secret Key</span>
                    <span class="work__item-arrow svg-data">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28">
                        <path fill="#FFFFFF" fill-rule="evenodd"
                          d="M14 0C6.273 0 0 6.273 0 14s6.273 14 14 14 14-6.273 14-14S21.727 0 14 0Zm3.586 13H8c-.552 0-1 .448-1 1s.448 1 1 1h9.586l-2.293 2.293c-.39.39-.39 1.024 0 1.414.39.39 1.024.39 1.414 0l4-4c.391-.39.391-1.024 0-1.414l-4-4c-.39-.39-1.024-.39-1.414 0-.39.39-.39 1.024 0 1.414L17.586 13Z">
                        </path>
                      </svg>
                    </span>
                  </div>
                  <div class="work__item-media">
                    <img src="http://www.alessioatzeni.com/assets/manzetti_thumb_ZcsmKr.webp" class="media__image"
                      alt="Manzetti Clothing Website" width="2072" height="1237" loading="lazy" decoding="async">
                  </div>
                </a>
              </div>
            </div>
            <div class="work__item work__item--2">
              <div class="work__item-box">
                <a href="https://www.lgrworld.com/" class="work__item-link" title="L.G.R" target="_blank"
                  rel="noopener noreferrer nofollow" data-pointer="link" data-pointer-text="Launch">
                  <div class="work__item-data">
                    <h3 class="work__item-title scroll-project-title" data-splitting>L.G.R</h3>
                    <span class="work__item-deco">03</span>
                  </div>
                  <div class="work__item-info">
                    <span class="work__item-number">03</span>
                    <span class="work__item-attrs">Development • Ecommerce • WordPress </span>
                    <span class="work__item-agency">Agency: Secret Key</span>
                    <span class="work__item-arrow svg-data">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28">
                        <path fill="#FFFFFF" fill-rule="evenodd"
                          d="M14 0C6.273 0 0 6.273 0 14s6.273 14 14 14 14-6.273 14-14S21.727 0 14 0Zm3.586 13H8c-.552 0-1 .448-1 1s.448 1 1 1h9.586l-2.293 2.293c-.39.39-.39 1.024 0 1.414.39.39 1.024.39 1.414 0l4-4c.391-.39.391-1.024 0-1.414l-4-4c-.39-.39-1.024-.39-1.414 0-.39.39-.39 1.024 0 1.414L17.586 13Z">
                        </path>
                      </svg>
                    </span>
                  </div>
                  <div class="work__item-media">
                    <img src="http://www.alessioatzeni.com/assets/manzetti_thumb_ZcsmKr.webp" class="media__image"
                      alt="Manzetti Clothing Website" width="2072" height="1237" loading="lazy" decoding="async">
                  </div>
                </a>
              </div>
            </div>
            <div class="work__item work__item--3">
              <div class="work__item-box">
                <a href="https://www.corojewels.com/" class="work__item-link" title="Co.Ro Jewels" target="_blank"
                  rel="noopener noreferrer nofollow" data-pointer="link" data-pointer-text="Launch">
                  <div class="work__item-data">
                    <h3 class="work__item-title scroll-project-title" data-splitting>Co.Ro Jewels</h3>
                    <span class="work__item-deco">04</span>
                  </div>
                  <div class="work__item-info">
                    <span class="work__item-number">04</span>
                    <span class="work__item-attrs">Development • Ecommerce • WordPress </span>
                    <span class="work__item-agency">Agency: Secret Key</span>
                    <span class="work__item-arrow svg-data">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28">
                        <path fill="#FFFFFF" fill-rule="evenodd"
                          d="M14 0C6.273 0 0 6.273 0 14s6.273 14 14 14 14-6.273 14-14S21.727 0 14 0Zm3.586 13H8c-.552 0-1 .448-1 1s.448 1 1 1h9.586l-2.293 2.293c-.39.39-.39 1.024 0 1.414.39.39 1.024.39 1.414 0l4-4c.391-.39.391-1.024 0-1.414l-4-4c-.39-.39-1.024-.39-1.414 0-.39.39-.39 1.024 0 1.414L17.586 13Z">
                        </path>
                      </svg>
                    </span>
                  </div>
                  <div class="work__item-media">
                    <img src="http://www.alessioatzeni.com/assets/manzetti_thumb_ZcsmKr.webp" class="media__image"
                      alt="Manzetti Clothing Website" width="2072" height="1237" loading="lazy" decoding="async">
                  </div>
                </a>
              </div>
            </div>
            <div class="work__item work__item--4">
              <div class="work__item-box">
                <a href="https://www.fing.com/" class="work__item-link" title="Fing" target="_blank"
                  rel="noopener noreferrer nofollow" data-pointer="link" data-pointer-text="Launch">
                  <div class="work__item-data">
                    <h3 class="work__item-title scroll-project-title" data-splitting>Fing</h3>
                    <span class="work__item-deco">05</span>
                  </div>
                  <div class="work__item-info">
                    <span class="work__item-number">05</span>
                    <span class="work__item-attrs">Development • Website • WordPress </span>
                    <span class="work__item-agency">Agency: Secret Key</span>
                    <span class="work__item-arrow svg-data">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28">
                        <path fill="#FFFFFF" fill-rule="evenodd"
                          d="M14 0C6.273 0 0 6.273 0 14s6.273 14 14 14 14-6.273 14-14S21.727 0 14 0Zm3.586 13H8c-.552 0-1 .448-1 1s.448 1 1 1h9.586l-2.293 2.293c-.39.39-.39 1.024 0 1.414.39.39 1.024.39 1.414 0l4-4c.391-.39.391-1.024 0-1.414l-4-4c-.39-.39-1.024-.39-1.414 0-.39.39-.39 1.024 0 1.414L17.586 13Z">
                        </path>
                      </svg>
                    </span>
                  </div>
                  <div class="work__item-media">
                    <img src="http://www.alessioatzeni.com/assets/manzetti_thumb_ZcsmKr.webp" class="media__image"
                      alt="Manzetti Clothing Website" width="2072" height="1237" loading="lazy" decoding="async">
                  </div>
                </a>
              </div>
            </div>

          </div>
        </div>
      </div>
    </section>
  </div>
</template>

<script setup>
import imageSrc from '/assets/Images/me.jpeg'; // Importing from assets

import { useAnimations } from "@/composables/useAnimations";

useAnimations();
const { $splitting } = useNuxtApp();

onMounted(() => {
  $splitting();
});

import { onMounted } from "vue";
import gsap from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";
import { Back } from 'gsap';

if (process.client) {
  gsap.registerPlugin(ScrollTrigger);
}

const matchMedia = gsap.matchMedia();

function projectPinnedSection() {
  document.querySelectorAll(".work__item").forEach((item, index, items) => {
    const isLast = index === items.length - 1;
    const media = item.querySelector(".work__item-media");
    const title = item.querySelector(".work__item-title");
    const chars = title.querySelectorAll(".char");

    gsap.set(chars, { perspective: 1000, "will-change": "opacity, transform", opacity: 0, z: -800 });

    const animateText = gsap.timeline().to(chars, {
      ease: "back.out(1.2)", opacity: 1, z: 0, stagger: 0.04,
      scrollTrigger: { trigger: title, start: "top 80%", end: "bottom 50%", scrub: true }
    });

    matchMedia.add("(min-width: 1024px)", () => {
      gsap.timeline({
        scrollTrigger: { trigger: item, start: "top 2.5%", end: "+=150%", pin: true, pinSpacing: false, scrub: true }
      })
        .to(item, {
          ease: "none", startAt: { filter: "brightness(100%)" },
          filter: isLast ? "none" : "brightness(0%)", opacity: 0, scale: 0.8, yPercent: isLast ? -100 : -15,
          onUpdate: () => item.classList.toggle("not-clickable", gsap.getProperty(item, "opacity") < 0.9)
        }, 0)
        .to(title, { ease: "none", yPercent: -100, opacity: 0 }, 0)
        .add(animateText, "<");
    });

    matchMedia.add("(max-width: 1023px)", () => {
      gsap.timeline({
        scrollTrigger: { trigger: item, start: "top 2.5%", end: "+=150%", pinSpacing: false, scrub: true }
      })
        .fromTo(media, { opacity: 0 }, { opacity: 1, duration: 1, scrollTrigger: { trigger: item, start: "top 80%", end: "bottom 50%", scrub: true } })
        .add(animateText, "<");
    });
  });
}

onMounted(projectPinnedSection);

</script>

<style>
.content-section__decorative {
  color: var(--col-text-deco);
  font-size: 33vw;
  font-weight: 900;
  line-height: 1;
  pointer-events: none;
  text-transform: uppercase;
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
  white-space: nowrap;
  z-index: -1;
}

.content-section__decorative,
.header__colors-picker,
.work__item-data,
.work__item-deco {
  left: 50%;
  position: absolute;
  text-align: center;
  top: 50%;
  transform: translate(-50%, -50%);
}

.char-wrap {
  display: inline-block;
  overflow: hidden;
}

.work__item {
  align-items: center;
  display: flex;
  height: 100vh;
  justify-content: center;
  position: relative;
  width: 100%
}

.work__item:last-child {
  margin-bottom: 0
}

.work__item-link {
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none
}

.work__item-box {
  margin: 0 auto;
  max-width: 137.5rem;
  width: 100%
}

.work__item-media {
  border: 1px solid var(--col-border);
  border-top: 0;
  height: 0;
  overflow: hidden;
  padding-bottom: 59.7007722008%;
  position: relative;
  width: 100%
}

.work__item-media:before {
  background-color: var(--overlay-project);
  content: "";
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
  z-index: 2
}

.work__item-media img {
  filter: grayscale(1)
}

.work__item-info {
  align-items: center;
  border: 1px solid var(--col-border);
  color: var(--col-text);
  display: flex;
  padding: .9375rem 1.25rem;
  position: relative
}

.work__item-info span {
  font-size: .875rem;
  font-weight: 500;
  text-transform: uppercase
}

.work__item-number {
  color: var(--col-accent)
}

.work__item-number:after {
  color: var(--col-border);
  content: "/";
  display: inline-block;
  margin: 0 .375rem;
  position: relative
}

.work__item-agency {
  margin-left: auto
}

.work__item-data {
  z-index: 3
}

.work__item-title {
  color: var(--col-text);
  font-family: CormorantGaramondPortfolio, serif;
  font-size: 6vw;
  font-weight: 500;
  line-height: 1;
  position: relative;
  white-space: nowrap;
  z-index: 2
}

.work__item-deco {
  color: var(--col-text-deco);
  font-size: 20vw;
  font-weight: 900;
  line-height: 1;
  z-index: 1
}

.work__item-arrow {
  display: none;
  height: 2rem;
  position: absolute;
  right: .625rem;
  top: 50%;
  transform: translateY(-50%);
  width: 2rem
}

.work__item-arrow path {
  fill: var(--col-arrow)
}

@media (min-width: 1025px) and (hover:hover) and (pointer:fine) {
  .work__item-media:before {
    opacity: 1;
    transition: opacity .35s var(--ease-in-out-sine)
  }

  .work__item-media img {
    transform: scale(1);
    transition: transform .45s var(--ease-in-out-back), filter .35s var(--ease-in-out-sine)
  }

  .work__item-data {
    opacity: 1;
    transition: opacity .35s var(--ease-in-out-sine)
  }

  html:not(.lenis-scrolling) .work__item-link:hover .work__item-media:before {
    opacity: 0
  }

  html:not(.lenis-scrolling) .work__item-link:hover .work__item-media img {
    filter: grayscale(0);
    transform: scale(1.025)
  }

  html:not(.lenis-scrolling) .work__item-link:hover .work__item-data {
    opacity: 0
  }
}

@media (max-width: 1024px) {
  .works__lists {
    margin-left: -1.875rem;
    width: calc(100% + 3.75rem)
  }

  .work__item {
    height: auto;
    margin-top: 20vh
  }

  .work__item-data {
    left: auto;
    margin-bottom: 8vh;
    position: relative;
    top: auto;
    transform: none
  }

  .work__item-deco {
    font-size: 10rem
  }

  .work__item-title {
    font-size: 3.75rem
  }

  .work__item-media {
    border: 0
  }

  .work__item-media:before {
    opacity: 0
  }

  .work__item-media img {
    filter: grayscale(0)
  }

  .work__item-link {
    display: flex;
    flex-direction: column
  }

  .work__item-info {
    align-items: flex-start;
    border-left: 0;
    border-right: 0;
    border-top: 0;
    flex-direction: column;
    order: 12;
    padding-left: .625rem;
    padding-right: .625rem
  }

  .work__item-info span:not(.work__item-arrow) {
    font-size: .75rem;
    margin-top: .5rem
  }

  .work__item-info span:not(.work__item-arrow):first-child {
    margin-top: 0
  }

  .work__item-agency {
    margin-left: 0
  }

  .work__item-arrow {
    display: block
  }
}

@media (max-width: 767px) {
  .works__lists {
    margin-left: -.9375rem;
    width: calc(100% + 1.875rem)
  }

  .work__item-deco {
    font-size: 6.25rem
  }

  .work__item-title {
    font-size: 2.25rem
  }

  .work__item-media {
    padding-bottom: 100%
  }

  .work__item-arrow {
    height: 1.5rem;
    width: 1.5rem
  }
}

.lab__lists {
  margin-top: 6.25rem
}
</style>